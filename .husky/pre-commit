#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "🔍 Running Next.js lint on staged files..."

# Get only staged JavaScript/TypeScript files
STAGED_FILES=$(git diff --cached --name-only --diff-filter=ACM | grep -E '\.(js|ts|jsx|tsx)$' || true)

if [ -z "$STAGED_FILES" ]; then
  echo "✅ No JavaScript/TypeScript files to lint. Skipping lint check."
  exit 0
fi


# If linting fails, exit with error
if [ $? -ne 0 ]; then
  echo "❌ Fix linting errors before committing!"
  exit 1
fi

# Ensure only modified files are staged again
git update-index --refresh

echo "✅ Lint check passed!"
exit 0

